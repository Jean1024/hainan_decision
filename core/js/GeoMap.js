define("GeoMap",["zrender","zrender/tool/util"],function(e,t){function r(r,o){var a=this;if(a.defaultCfg={offset:null,showName:!1,mapStyle:{hoverable:!1,clickable:!0,onclick:function(){},style:{strokeColor:"#3D534E",color:"#f5f3f0",textColor:"#f00",textPosition:"left",brushType:"both"}},weatherStyle:{hoverable:!1,clickable:!0,zlevel:1,style:{strokeColor:"rgba(25, 206, 250, 0.8)",color:"#00f",textColor:"#f00",textPosition:"bottom",r:14}}},t.mergeFast(o,a.defaultCfg,!1,!0),a.config=o,a.container=document.getElementById(a.config.container),0==a.container.length)return s.log("传入ID无法在页面中找到！"),!1;a.zr=e.init(a.container),a.width=a.defaultCfg.width||a.zr.getWidth(),a.height=a.defaultCfg.height||a.zr.getHeight(),a.offset=a.config.offset,self.scale=a.config.scale,a.paths=null,a.weatherShapes=[];var p=new n;return a.makePoint=function(){return p.makePoint.apply(p,arguments)},a.load=function(e,r){r&&a.updateCfg(r),a.json=e,a.paths=p.json2path(e,a);for(i in a.paths)t.mergeFast(a.paths[i],a.config.mapStyle,!1,!0),a.zr.addShape(a.paths[i])},a.render=function(e){a.zr.render(e)},a.updateCfg=function(e,r){r?t.mergeFast(e,a.defaultCfg,!1,!0):t.mergeFast(e,a.config,!1,!0),a.config=e},a.loadWeather=function(e,r,o){o&&a.updateCfg(o);for(spaheid in a.weatherShapes)a.zr.delShape(a.weatherShapes[spaheid]);a.refresh(function(){a.weatherShapes=[],a.weatherjson=e,a.weatherpaths=e?p.json2path(e,a):[],s.log(a.weatherpaths),a.weatherShowid=r?r:void 0;for(i in a.weatherpaths)r&&(a.weatherShowid=r,s.log(a.weatherpaths[i].pshapeId),a.weatherpaths[i].pshapeId!=r)||(t.mergeFast(a.weatherpaths[i],a.config.weatherStyle,!1,!0),a.zr.addShape(a.weatherpaths[i]),s.log(a.weatherpaths[i]),a.weatherShapes.push(a.weatherpaths[i].id));a.refresh()})},a.refresh=function(e){a.zr.refresh(e)},a.clear=function(){p.scale=null,p.offset=null,p.pathArray=[],a.weatherShapes=[],a.scale=null,a.offset=null,a.zr.clear()},a.refreshWeather=function(e){a.loadWeather(a.weatherjson,e)},a.resize=function(){a.zr.resize(),a.clear(),a.width=a.defaultCfg.width||a.zr.getWidth(),a.height=a.defaultCfg.height||a.zr.getHeight(),a.load(a.json),a.refreshWeather(a.weatherShowid)},a}function o(){var e=this;return e.formatPoint=function(e){return[(e[0]<-168.5?e[0]+360:e[0])+170,90-e[1]]},e.makePoint=function(t){point=e.formatPoint(t),x=point[0],y=point[1],e.xmin>x&&(e.xmin=x),e.xmax<x&&(e.xmax=x),e.ymin>y&&(e.ymin=y),e.ymax<y&&(e.ymax=y)},e.Point=function(t){e.makePoint(t)},e.LineString=function(e){for(var t=this,r=0,o=e.length;o>r;r++)t.makePoint(e[r])},e.Polygon=function(t){for(var r=0,o=t.length;o>r;r++)e.LineString(t[r])},e.MultiPoint=function(t){for(var r=0,o=t.length;o>r;r++)e.Point(t[r])},e.MultiLineString=function(t){for(var r=0,o=t.length;o>r;r++)e.LineString(t[r])},e.MultiPolygon=function(t){for(var r=0,o=t.length;o>r;r++)e.Polygon(t[r])},e.parseSrcSize=function(t){var r,o,n,i,a,s,p,h=t.features;for(e.xmin=360,e.xmax=0,e.ymin=180,e.ymax=0,o=0,i=h.length;i>o;o++)if(p=h[o],"Feature"==p.type)e.pushApath(p.geometry,p);else if(p.type="GeometryCollection")for(r=p.geometries,n=0,a=r.length;a>n;n++)s=r[n],e.pushApath(s,s);e.srcSize={left:1*e.xmin.toFixed(4),top:1*e.ymin.toFixed(4),width:1*(e.xmax-e.xmin).toFixed(4),height:1*(e.ymax-e.ymin).toFixed(4)}},e.pushApath=function(t){shapeType=t.type,shapeCoordinates=t.coordinates,e[shapeType](shapeCoordinates)},e}function n(){var e=this;return e.pathArray=[],e.json2path=function(t,r){e.pathArray=[];var n,i,a,s,p,h,l,f=t.features;if(e.scale=null,e.offset=null,convertor_parse=new o,r.scale&&r.offset||convertor_parse.srcSize||convertor_parse.parseSrcSize(t),r.offset?convertor_parse.srcSize&&(r.offset.x=convertor_parse.srcSize.left+r.config.offset.x,r.offset.y=convertor_parse.srcSize.top+r.config.offset.y):r.offset={x:convertor_parse.srcSize.left,y:convertor_parse.srcSize.top},!r.scale){var c=r.width/convertor_parse.srcSize.width,g=r.height/convertor_parse.srcSize.height;c>59*g?c=.73*g:c/.73>g?c=.73*g:g=c/.73,r.scale={x:c,y:c}}for(e.scale=r.scale,e.offset=r.offset,i=0,s=f.length;s>i;i++)if(l=f[i],"Feature"==l.type)e.pushApath(l.geometry,l,r);else if("GeometryCollection"==l.type)for(n=l.geometries,a=0,p=n.length;p>a;a++)h=n[a],e.pushApath(h,h,r);return e.pathArray},e.pushApath=function(r,o,n){if(shapeType=r.type,shapeCoordinates=r.coordinates,polygonList=e[shapeType](shapeCoordinates),"Point"==shapeType){var i={shape:"text",style:{text:o.properties.value,x:polygonList[0],y:polygonList[1]},draggable:!1};if(void 0!==o.properties.color&&(i.style.color=o.properties.color),void 0!==o.properties.prov_name&&(i.pshapeId=o.properties.prov_name),!i.id){var a=n.zr.newShapeId("weatherShape");i.id=a}e.pathArray.push(i)}else if("PointCircle"==shapeType){var i={shape:"circle",id:o.properties.id||n.zr.newShapeId("weatherShape"),style:{x:polygonList[0],y:polygonList[1]}};n.config.showName&&(i.style.text=o.properties.text),void 0!==o.properties.color&&(i.style.color=o.properties.color),void 0!==o.properties.title&&(i.style.title=o.properties.title),void 0!==o.properties.prov_name&&(i.pshapeId=o.properties.prov_name),e.pathArray.push(i)}else if("PointImage"==shapeType){var i={shape:"image",id:o.properties.id||n.zr.newShapeId("weatherShape"),style:{x:polygonList[0],y:polygonList[1]}};t.mergeFast(i.style,o.properties,!1,!0);try{i.style.x-=parseInt(i.style.width)/2,i.style.y-=parseInt(i.style.height)/2}catch(p){}void 0!==o.properties.prov_name&&(i.pshapeId=o.properties.prov_name),void 0!==o.properties.rotation&&(i.rotation=new Array,i.rotation[0]=o.properties.rotation/180*Math.PI,i.rotation[1]=parseFloat(polygonList[0]),i.rotation[2]=parseFloat(polygonList[1]+parseInt(i.style.height))),s.log(i),e.pathArray.push(i)}if("Polygon"==shapeType||"MultiPolygon"==shapeType)for(polygoni in polygonList){var i={shape:"polygon",hoverable:!1,zlevel:0,id:o.id,style:{pointList:polygonList[polygoni]}};e.pathArray.push(i),n.config.showName&&(cp=e.makePoint(o.properties.cp),e.pathArray.push({shape:"text",id:o.id+"text",zlevel:2,clickable:!0,hoverable:!1,style:{color:"#000",lineWidth:.01,text:o.properties.name,x:cp[0],y:cp[1],textFont:"18px Calibri"},draggable:!1}))}},e.formatPoint=function(e){return[(e[0]<-168.5?e[0]+360:e[0])+170,90-e[1]]},e.makePoint=function(t){var r=this,o=r.formatPoint(t),n=(o[0]-e.offset.x)*e.scale.x,i=(o[1]-e.offset.y)*e.scale.y;return[n,i]},e.Point=function(t){return t=e.makePoint(t)},e.PointCircle=function(t){return t=e.makePoint(t)},e.PointImage=function(t){return t=e.makePoint(t)},e.LineString=function(t){for(var r,o=0,n=t.length,i=new Array;n>o;o++)r=e.makePoint(t[o]),i.push(r);return i},e.Polygon=function(t){for(var r=0,o=t.length,n=new Array;o>r;r++)n.push(e.LineString(t[r]));return n},e.MultiPoint=function(t){for(var r=[],o=0,n=t.length;n>o;o++)r.push(e.Point(t[o]));return r},e.MultiLineString=function(t){for(var r="",o=0,n=t.length;n>o;o++)r+=e.LineString(t[o]);return r},e.MultiPolygon=function(t){for(var r=0,o=t.length,n=[];o>r;r++)n=n.concat(e.Polygon(t[r]));return n},e}var a={},s=a,p=0,h={};return a.version="1.0.4",a.init=function(e){var t=new r(++p,e);return h[p]=t,t},a.debugMode=0,a.log=function(){if(0!==a.debugMode){if(1==a.debugMode)for(var e in arguments)throw new Error(arguments[e]);else if(a.debugMode>1)for(var e in arguments)console.log(arguments[e]);return a}},a});