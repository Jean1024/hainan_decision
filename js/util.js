!function(e){if(!function(){var t=e.OS={},a=navigator.userAgent;~a.indexOf("Android")?t.isAndroid=!0:$.browser.safari?t.isIOS=!0:t.isPC=!0}(),!function(){var t=0,a={};e.command=function(e,n,i){var o=[].slice.call(arguments);2==o.length&&"function"==typeof n&&(i=n,n=null);var r=[];if(n)for(var c in n)r.push(c+"="+n[c]);if(i){var s=(new Date).getTime()+"_"+t++;a[s]=function(){i.apply(this,arguments),delete a[s]},r.push("cb="+s)}var l=r.length>0?"?"+r.join("&"):"",u=encodeURI("js://"+e+l);console.log("src:"+u);$('<iframe onload="var $this = $(this);setTimeout(function(){$this.remove();},1000)">').hide().appendTo($("body")).attr("src",u)},e.command.callback=function(e,t){var n=a[e];if(isNaN(t)){t=t.replace(/\r/g,"").replace(/\n/g,"\\n");try{t=JSON.parse(t)}catch(i){}}console.log(JSON.stringify(t)),n&&n(t)}}(),e.alert=function(t){t&&e.command("alert",{msg:t})},"undefined"!=typeof localStorage){var t=localStorage,a="w_",n=function(e){return a+e},i={set:function(e,a){if(void 0===a||null===a)return i.rm(e);try{var o=JSON.stringify(a);return t.setItem(n(e),o),!0}catch(r){console.log(r)}},get:function(e){var t=localStorage[n(e)];if(void 0!=t&&null!=t){try{t=JSON.parse(t)}catch(a){}return t}},rm:function(e){e=n(e),e?t.removeItem(e):t.clear()},rmAll:function(){for(var e in t)0==e.indexOf(a)&&t.removeItem(e)}};e.Store=i}!function(){var t,a,n=0,i=!0,o=function(t){var a=(new Date).getTime();n&&n>a?t&&t(i):e.OS.isIOS||e.OS.isAndroid?e.command("isCanUseNetwork",function(e){i=!!e,n=a+2e4,t&&t(i)}):t&&t(!0)},r=!1,c={};e.getJson=function(n,i,s){var l=encodeURIComponent(n),u=c[l];try{var d=s.no_cache}catch(f){}if(u&&!d)i(u);else{var v;if(s){var g=s.onerror;$.isFunction(g)&&(v=g)}$.ajax({async:!0,cache:!0,url:n,type:"GET",timeout:2e4,success:function(t){if(t.indexOf("_callback")>-1){var a=/^_callback\(([\s\S]*)\)$/.exec(t);a&&(t=a[1])}else 0==t.indexOf("var")&&(t=t.substring(t.indexOf("{"),t.lastIndexOf("}")+1));try{t=JSON.parse(t)}catch(n){t=t.replace(/\t/g,"");try{t=JSON.parse(t)}catch(o){return e.alert("数据解析错误1"),void(v&&v(n))}}if(s){var r=s.format;$.isFunction(r)&&(t=r(t))}c[l]=t,t&&i&&i(t)},error:function(n,i){var c;switch(i){case"timeout":c="请求超时";break;case"parsererror":c="数据解析错误";break;case"abort":break;case"error":var s=n.status;if(404==s){c="请求地址不存在";break}if(0==s&&0==n.readyState){if(r)return;o(function(n){n?v&&v():(c="当前网络不可用，请检查网络设置",clearTimeout(a),a=setTimeout(function(){e.alert(c)},100),v&&v(),r=!0,clearTimeout(t),t=setTimeout(function(){r=!1},5e3))});break}c="数据加载错误";case"notmodified":return}c&&(clearTimeout(a),a=setTimeout(function(){e.alert(c)},100),v&&v())}})}};var s=e.Store;e.initData=function(t,a,n,i,o){var r=s.get(t),c=function(n){a=e.getEncodeUrl(a),e.getJson(a,function(e){s.set(t,e),n&&n(e)},{no_cache:i,format:o})};r&&!i?(n(r),c()):c(n)}}();var o=3e4;e.getGeoInfo=e.OS.isPC?function(t){var a="ip_geo_info",n=i.get(a);if(n)t&&t(n);else{var r=function(){t&&t(DEFAULT_CONFIG.geo)},c=setTimeout(function(){r()},o);window.id_callback=function(){if(clearTimeout(c),!id)return r();var n={id:id,ip:ip};e.getJson(e.getEncodeUrl("http://webapi.weather.com.cn/data/?areaid="+id+"&type=forecast7d"),function(e){e?(e=e.c,n.city=e.c5,n.district=e.c3,n.province=e.c7,n.nation=e.c9,i.set(a,n),t&&t(n)):r()})},$.getScript("http://geo.weather.com.cn/g/")}}:function(t,a){var n="aread_time",r="geo_info",c=i.get(r);if(c&&(parseInt(i.get(n))||Number.MAX_VALUE)>(new Date).getTime())return console.log("cache: "+JSON.stringify(c)),void(t&&t(c));var s=function(n){$.isFunction(a)?a(n):e.alert("为了得到更好的定位服务，请开启位置服务（设置->位置服务）;code("+n+")"),t(DEFAULT_CONFIG.geo)},l=navigator.geolocation,u=function(a){var o=a.coords.latitude,s=a.coords.longitude;e.getJson(e.getEncodeUrl("http://geo.weather.com.cn/ag9/?lon="+s+"&lat="+o),function(a){a&&0==a.status?(c=a.geo,console.log(JSON.stringify(c)),i.set(r,c),i.set(n,(new Date).getTime()+18e5),t&&t(c)):(e.alert("请求城市信息出错："+a.msg),t&&t(DEFAULT_CONFIG.geo))})},d=function(){var t,a=!1;return function(n){t=setTimeout(function(){a=!0,s(n)},o),e.command("getGeo",function(e){clearTimeout(t),a||(e.lat&&e.lon?u({coords:{latitude:e.lat,longitude:e.lon}}):s(n))})}}();!l||e.OS.isIOS||e.OS.isAndroid?d(2):l.getCurrentPosition(u,function(){d(1)},{maximumAge:12e4,timeout:o})},e.getAreaId=function(){var e,t=i.get("geo_info");return t&&(e=t.id),e=e||101010100},e.getEncodeUrl=function(e){var t="a1b42a4dccd7493f",a=new Date,n=a.getFullYear()+""+(parseInt(a.getMonth())+1)+a.getDate()+a.getHours()+a.getMinutes();e+=(~e.indexOf("?")?"&":"?")+"date="+n+"&appid="+t;var i="chinaweather_jcb_webapi_data",o=base64encode(str_hmac_sha1(i,e));return o=encodeURIComponent(o),e.replace(/appid=.*/,"appid="+t.substr(0,6))+"&key="+o},e.getAppInfo=function(t,a){function n(t){a||setTimeout(function(){var a=DEFAULT_CONFIG.appinfo_url;a&&e.getJson(a,function(e){r=!0,i.set("appinfo",e),t&&t(e,3)})},1e3)}var o=i.get("appinfo");if(o)t(o,1),n();else{var r=!1;t(DEFAULT_CONFIG.appinfo,2),n()}},!function(){e.getScroll=function(e,t){t=$.extend({scrollX:!0,mouseWheel:!0,tap:!0,disableMouse:IScroll.utils.hasTouch,click:!0},t);var a=new IScroll(e,t);return a}}()}(this.Util={}),!function(){var e,t,a=3,n=function(){clearTimeout(t)},i=$("body");Util.Loading={show:function(){e||(e=$("<div>").addClass("loading").appendTo($("body"))),n(),t=setTimeout(function(){e.show(),i.addClass("b_loading")},a)},hide:function(){n(),e&&e.hide(),i.removeClass("b_loading")}}}(),!function(){var e=Util,t=isShowSubMap=!1;e.canBack=function(a,n){"nav"==n?t=a:isShowSubMap=a,e.command(t||isShowSubMap?"setNoBack":"setCanBack")}}(),!function(){var e=Util,t={};e.invoke=function(e){var a=t[e];if($.isFunction(a)){var n=[].slice.call(arguments,1);a.apply(null,n)}},e.invoke.reg=function(e,a){t[e]=a},e.invoke.rm=function(e){delete t[e],t[e]=null}}(),!function(e){var t,a=$(document),n=Util,i=n.Loading,o=!1,r=n.Store,c=/\/([^\/]+)\.html/,s=c.exec(location.pathname);if(s)var l=s[1];var u="_",d=function(e){location.href=e};e.init=function(e){i.show();var o="./"+l+".html";n.getAppInfo(function(c){i.hide();var s=c.list,l=r.get("columnId"),g=r.get("twoId"),m=$('<div class="nav_left nav_animate"><div class="nav_left_c"><ul><li class="on">首页</li></ul><div class="bg"></div></div></div>');t=$(".nav_animate"),t=t.add(m);var p,h="";$.each(s,function(e,t){var a=t.id,n=t.columnstyle,i=t.small,o="",r=!1;if(i){var c,s="";$.each(t.small,function(e,t){var i=t.name,o=t.id,l=t.columnstyle||n;if(o==g&&(p=i),i==u)return void(c=o);var d="weburl"==t.module?' data-url="'+t.dataurl+'"':"";s+='<li class="'+(g==o&&(r=!0)?" on":"")+'" data-id="'+a+'" data-sid="'+o+'" data-style="'+l+'"'+d+">"+i+"</li>"}),o='<li class="s" '+(r?'style="display:block"':"")+"><ul>"+s+"</ul></li>"}h+="<li "+(l!=a||r?"":'class="on"')+" "+(c?'data-sid="'+c+'"':"")+' data-id="'+a+'" data-style="'+n+'"'+("weburl"==t.module?' data-url="'+t.dataurl+'"':"")+">"+t.name+"</li>"+o});var _=m.find("ul").append(h).find("li").on("click",function(e){e.stopPropagation();var t=$(this);a.trigger("before_nav_click",t),_.removeClass("on"),t.addClass("on");var i,c=t.data("url");if(c)i=c;else{var s=t.data("id"),l=t.data("sid"),u=t.data("style");if(s||u){if(r.set("columnId",s),!l){var f=t.next();if(f.is(".s"))return y&&!y.is(f)&&y.hide(),void(y=f.toggle(function(){w.refresh(),w.scrollToElement(f.prev().get(0))}))}r.set("twoId",l),r.rm("threeId"),i="./item.html",1==u?i="./geomap.html":2==u&&(i=n.OS.isAndroid?"wisp://typhoon.wi":"./typhoon.html")}else i="./index.html"}v(),i&&(o!=i?d(i):a.trigger("sort_change"))}),y=_.filter(".s[style]");l&&_.first().removeClass("on"),e&&e(m);var b=r.get("is_c_b");b&&g&&p!=u&&f(),r.rm("is_c_b"),m.height($(window).height());var w=Util.getScroll(m.find(".nav_left_c").get(0),{scrollX:!1}),k=m.find(".on").get(0);k&&w.scrollToElement(k),w.on("flick",function(){var e=Math.abs(this.distX),t=Math.abs(this.distY);e>t&&this.distX<0&&v()})})},e.changeBig=function(e){var t=$(".nav_left_c li[data-id="+e+"]"),a=t;if(!t.is(".s,[data-style=2]")){var n=t.next().find("li:first");n.length>0&&(a=n)}r.set("is_c_b",!0),a.click()};var f=function(){o=!0,a.trigger("nav_toggle"),t.addClass("nav_left_show"),n.canBack(!0,"nav")},v=function(){o=!1,a.trigger("nav_toggle"),t.removeClass("nav_left_show"),n.canBack(!1,"nav")};e.toggle=function(e){o||e===!0?v():f()},a.on("menu",e.toggle),e.isShow=function(){return o},!function(t){var o,c,s,f=10,v=11,g=12,m=2,p=2,h=function(e){return e=e||"",c||(c=$('<div class="nav_top nav_animate"><div class="nav_title"><span id="btn_nav"></span><h1>'+e+"</h1></div></div>"),c.on("click",function(e){var t=$(e.target);if(t.is("li")){t.siblings().removeClass("on"),t.addClass("on");var a=t.data("id");r.set("threeId",a),_(o[a])}})),c.find("h1").text(e),c},_=function(e){var t=e.module,n="json"==t||"imgs"==t&&1==e.typeproperty,i="geomap"==l;n&&!i?d("./geomap.html"):!n&&i?d("./item.html"):a.trigger("init_data",e)},y=function(e){for(var t,a,n,i=r.get("columnId"),o=r.get("twoId"),c=r.get("threeId"),s=e.list,l=0,d=s.length;d>l;l++){var h=s[l];if(h.id==i){t=h;break}}if(t){var _,s=t.small;if(t.type!=m&&t.columnstyle!=p&&s&&0!=s.length){if(s&&s.length>0){o||(o=s[0].id);for(var l=0,d=s.length;d>l;l++){var h=s[l];if(h.id==o){a=h;break}}if(a){if(n=a.small,n&&n.length>0){var y={};c||(c=n[0].id),$.each(n,function(e,t){var a=t.id;y[a]={l_url:t.listdataurl,d_url:t.dataurl,module:t.module,type:t.type,cstyle:t.columnstyle,typeproperty:t.typeproperty}}),_={list:n,data:y,on_id:c,type:g}}else _={type:v,on_id:0,data:{l_url:a.listdataurl,d_url:a.dataurl,module:a.module,type:a.type,cstyle:a.columnstyle,typeproperty:a.typeproperty}};var b=a.name;b==u&&(b=t.name),_.title=b}}}else _={type:f,on_id:0,data:{l_url:t.listdataurl,d_url:t.dataurl,module:t.module,type:t.type,cstyle:t.columnstyle,typeproperty:t.typeproperty},title:t.name};return _}},b=function(e,t){var a=h(e.title);a.find(".nav_top_c").remove();var i=e.type;if(o=null,i==g){o=e.data;var r='<div class="nav_top_c"><ul>',c=e.on_id,l=e.list;$.each(l,function(e,t){var a=t.id;r+='<li class="fl'+(c==a?" on":"")+'" data-id="'+a+'">'+t.name+"</li>"}),r+="</ul></div>";var u=$(r);a.append(u),t&&t();var d=10,m=u.find("li").each(function(){d+=$(this).outerWidth()+20});m.parent().width(d),s&&s.destroy(),s=n.getScroll(u.get(0)),s.scrollToElement(m.filter(".on").click().get(0))}else(i==v||i==f)&&(t&&t(),_(e.data))};t.init=function(t,o){i.show(),n.getAppInfo(function(c){i.hide();var s=h();t&&t(s);var l=function(){var e=y(c);e&&b(e,o)};l(),a.on("sort_change",l),e.init(function(e){e.insertBefore(s)}),$("#btn_nav").click(function(){e.toggle()}),n.invoke.reg("nav",function(e,t,a){r.set("columnId",e),r.set("twoId",t),r.set("threeId",a),l()})})},t.title=function(e){h(e)}}(e.Top={})}(Util.Nav={}),!function(e){e.weatherText=function(e){var t={};return t["00"]="晴",t["01"]="多云",t["02"]="阴",t["03"]="阵雨",t["04"]="雷阵雨",t["05"]="雷阵雨伴有冰雹",t["06"]="雨夹雪",t["07"]="小雨",t["08"]="中雨",t["09"]="大雨",t[10]="暴雨",t[11]="大暴雨",t[12]="特大暴雨",t[13]="阵雪",t[14]="小雪",t[15]="中雪",t[16]="大雪",t[17]="暴雪",t[18]="雾",t[19]="冻雨",t[20]="沙尘暴",t[21]="小到中雨",t[22]="中到大雨",t[23]="大到暴雨",t[24]="暴雨到大暴雨",t[25]="大暴雨到特大暴雨",t[26]="小到中雪",t[27]="中到大雪",t[28]="大到暴雪",t[29]="浮尘",t[30]="扬沙",t[31]="强沙尘暴",t[53]="霾",t[99]="无",t[e]||"无"},e.weatherIcon=function(e,t){var a=/(\d{2}):\d{2}/.exec(e);return Hours=a?a[1]:(new Date).getHours(),"./img/weather/icon_weather_"+(Hours>=18||6>=Hours?"night":"day")+"_"+t+".png"},e.weatherBg=function(e,t){var a=/(\d{2}):\d{2}/.exec(e);Hours=a?a[1]:(new Date).getHours();var n=Hours>=18||6>=Hours;t=parseInt(t);var i;switch(t){case 0:i=(n?"n":"")+"00";break;case 1:i=(n?"n":"")+"01";break;case 2:case 33:i="02";break;case 3:case 6:case 7:case 19:case 21:i=(n?"n":"")+"03";break;case 4:case 5:i="04";break;case 8:case 9:case 10:case 11:case 12:case 22:case 23:case 24:case 32:case 25:i="10";break;case 13:case 14:case 15:case 16:case 17:case 26:case 27:case 28:case 34:i="15";break;case 18:case 35:case 53:i="18";break;case 20:case 29:case 30:case 31:i="20"}return i||(i=(n?"n":"")+"00"),"./img/bg_weather/static_"+i+".jpg"},e.windDirec=function(e){var t={};return t[0]="无持续风",t[1]="东北风",t[2]="东风",t[3]="东南风",t[4]="南风",t[5]="西南风",t[6]="西风",t[7]="西北风",t[8]="北风",t[9]="旋转风",t[e]||""},e.windLevel=function(e,t){if(t)return 0==e?"微风":e+"级";var a={};return a[0]="微风",a[1]="3-4级",a[2]="4-5级",a[3]="5-6级",a[4]="6-7级",a[5]="7-8级",a[6]="8-9级",a[7]="9-10 级",a[8]="10-11 级",a[9]="11-12 级",a[e]||""},e.week=function(e,t){var a=new Date(e);t>0&&a.setDate(a.getDate()+t);var n="";switch(a.getDay()){case 0:n+="周日";break;case 1:n+="周一";break;case 2:n+="周二";break;case 3:n+="周三";break;case 4:n+="周四";break;case 5:n+="周五";break;case 6:n+="周六"}return n}}(Util.Parse={}),!function(e){var t="my_city",a=Util.Store;e.City={get:function(){return a.get(t)||[]},set:function(e,n){var i=this.get()||[];i.push({id:e,name:n});var o={},r=[];$.each(i,function(e,t){var a=t.id;o[a]||(o[a]=a,r.push(t))}),a.set(t,r)},rm:function(e){for(var n=this.get()||[],i=-1,o=0,r=n.length;r>o;o++){var c=n[o];if(c.id==e){i=o;break}}i>-1&&n.splice(i,1),a.set(t,n)}}}(Util.My={});